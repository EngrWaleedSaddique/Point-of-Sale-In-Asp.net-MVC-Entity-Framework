@model EditViewModel
<script src="~/Client/plugins/jquery-validation/jquery.validate.min.js"></script>
<div class="content-wrapper">
    <!-- pages navigates here -->
    <section class="content">
        <div class="row">
            <div class="col-xs-12 col-md-12 col-sm-12">
                <div class="box " id="print-section">
                    <div class="box-header">
                        <h3 class="box-title">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                            Add New Product
                        </h3>
                    </div>
                    <form id="createProduct" method="post">
                        <div class="box-body ">
                            <h4 class="purchase-heading"> <i class="fa fa-check-circle"></i> Product Info</h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Product Name:</label>
                                        <input type="text" name="ProductName" value="@Model.product.ProductName" class="form-control input-lg" placeholder="e.g Panadol" reqiured="" />
                                    </div>
                                    <small>Name of the medicine or product ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Generic Name:</label>
                                        <input type="text" name="GenericName" value="@Model.product.GenericName" class="form-control input-lg" placeholder="e.g Paracetamol" reqiured="" />
                                    </div>
                                    <small>Name of the product ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Batch No:</label>
                                        <input type="text" name="BatchNo" value="@Model.product.BatchNo" class="form-control input-lg" placeholder="e.g Batch No" reqiured="" />
                                    </div>
                                    <small>Sku or Batch No ?  </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Barcode:</label>
                                        <input type="text" name="BarCode" value="@Model.product.BarCode" class="form-control input-lg" placeholder="e.g 000025444255658" reqiured="" />
                                    </div>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Description:</label>
                                        <textarea name="Description" class="form-control" rows="5">@Model.product.Description</textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label> Type: <a onclick="show_modal_page('https://medix.spantiklab.com/product/popup/add_product_type_model')" href="javascript:void(0)"> (Add Type)</a></label>
                                        <select class="form-control select2" name="MedicineTypeId" id="category_id" style="width: 100%;">
                                            <option value="">Select Type</option>
                                            @foreach (var type in Model.medicinesTypes)
                                            {
                                                var selected = type.Id == Model.product.MedicineTypeId ? "selected" : string.Empty;
                                                <option value="@type.Id" @selected>@type.Name</option>
                                            }
                                        </select>

                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Upload item image:</label>
                                        <div class="input-group">
                                            <input type="file" name="ImageURL" data-validate="required" value="@Model.product.ImageURL" class="form-control input-lg" data-message-required="Value Required">
                                        </div>
                                    </div>
                                    <small>Product scan or captured image ?</small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Discount (%): </label>
                                        <input type="number" name="CustDiscount" value="@Model.product.CustDiscount" class="form-control input-lg" id="" placeholder="e.g 5" step="any" />
                                    </div>
                                    <small>Discount offer to customers in % </small>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"> <i class="fa fa-check-circle"></i> Grouping</h4>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label> Company: <a onclick="show_modal_page('https://medix.spantiklab.com/product/popup/add_brand_model')" href="javascript:void(0)"> (add Company)</a></label>
                                        <select class="form-control select2" name="CompanyId" id="category_id" style="width: 100%;">
                                            <option value="">Select Company</option>
                                            @foreach (var company in Model.companies)
                                            {
                                                var selected = company.Id == Model.product.CategoryId ? "selected" : string.Empty;
                                                <option value="@company.Id" @selected>@company.Name</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label> Distributor: <a onclick="show_modal_page('https://medix.spantiklab.com/product/popup/add_brand_sector')" href="javascript:void(0)"> (add Distributor)</a></label>
                                        <select class="form-control select2" name="DistributorId" id="category_id" style="width: 100%;">
                                            <option value="">Select Distributor</option>
                                            @foreach (var distributor in Model.distributors)
                                            {
                                                var selected = distributor.Id == Model.product.DistributorId ? "selected" : string.Empty;
                                                <option value="@distributor.Id" @selected>@distributor.Name</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label> Category: <a onclick="show_modal_page('https://medix.spantiklab.com/product/popup/add_category_model')" href="javascript:void(0)"> (add category)</a></label>
                                        <select class="form-control select2" name="CategoryId" id="category_id" style="width: 100%;">
                                            <option value="">Select Category</option>
                                            @foreach (var category in Model.categories)
                                            {
                                                var selected = category.Id == Model.product.CategoryId ? "selected" : string.Empty;
                                                <option value="@category.Id" @selected>@category.Name</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"><i class="fa fa-check-circle"></i> Extra information </h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Minimum stock level required:</label>
                                        <input type="number" name="MinStock" value="@Model.product.MinStock" class="form-control input-lg" placeholder="e.g 20" reqiured="" />
                                    </div>
                                    <small>Product alert indicator level ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Side Effects:</label>
                                        <input type="text" name="SideEffects" value="@Model.product.SideEffects" class="form-control input-lg" id="sideeffects" placeholder="e.g avoid childrens" reqiured="" />
                                    </div>
                                    <small>Side effects of product ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Pack Size: </label>
                                        <input type="number" name="PackSize" value="@Model.product.PackSize" class="form-control input-lg" id="unit_per_pack" onkeyup="calculate_quantity()" placeholder="e.g 12" reqiured="" />
                                    </div>
                                    <small>Total number of products in each pack ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Unit Location in store: </label>
                                        <input type="text" name="Location" value="@Model.product.Location" class="form-control input-lg" placeholder="Top right corner" reqiured="" />
                                    </div>
                                    <small>Location where you stored this product in store. </small>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"><i class="fa fa-check-circle"></i> Manufacturing & Expiry Date </h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Manufacturing Date :</label>
                                        <input type="date" name="ManufactureDate" value="@(Model.product.ManufactureDate.ToString("yyy-MM-dd"))" class="form-control input-lg" reqiured="" />
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Expiry Date :</label>
                                        <input type="date" name="ExpiryDate" value="@Model.product.ExpiryDate.ToString("yyy-MM-dd")" class="form-control input-lg" reqiured="" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"><i class="fa fa-check-circle"></i> Pricing & Costing </h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Unit Cost Price:</label>
                                        <input type="number" name="UnitCost" value="@Model.product.UnitCost" class="form-control input-lg" step="any" />
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Unit Retail Price:</label>
                                        <input type="number" name="UnitRetail" value="@Model.product.UnitRetail" class="form-control input-lg" step="any" />
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Pack Cost Price:</label>
                                        <input type="number" name="PackCost" value="@Model.product.PackCost" class="form-control input-lg" step="any" />
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Retail Cost Price :</label>
                                        <input type="number" name="PackRetailCost" value="@Model.product.PackRetailCost" class="form-control input-lg" step="any" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"><i class="fa fa-check-circle"></i> Taxing % </h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Sales Tax% :</label>
                                        <input type="number" name="SalesTax" value="@Model.product.SalesTax" class="form-control input-lg" placeholder="2.30" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input type="hidden" name="Id" value="@Model.product.Id" />
                        <div class="box-body bg-setting-product">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <button id="updateBtn" name="updateBtn" class="btn btn-info btn-flat btn-lg pull-right" value="true"><i class="fa fa-floppy-o" aria-hidden="true"></i> Update Product</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <!-- Bootstrap model  -->
    <style>
        .modal-backdrop {
            z-index: -1;
        }
    </style>
    <div class="modal fade" id="page_model_view_data">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-body" style="height:500px; overflow:auto;">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div><!-- Bootstrap model  ends-->
</div>
<script src="~/Client/dist/js/sweetalert.min.js"></script>
<!-- /.content-wrapper -->
<!-- ./wrapper -->
<script>
    //To use validate insert the juery validate library also.
    $('#createProduct').validate({
        rules: {
            ProductName: { required: true },//minlength: 1,//maxlength: 100},
            GenericName: { required: true, maxlength: 100 },
            BatchNo: { required: true, maxlength: 100 },
            BarCode: { required: true, maxlength: 100 },
            Description: { maxlength: 500 },
            Type: { required: true },
            CompanyId: { required: true },
            DistributorId: { required: true },
            CategoryId: { required: true },
            MinStock: { required: true },
            PackSize: { required: true },
            Location: { required: true },
            ManufactureDate: { required: true },
            ExpiryDate: { required: true },
            UnitCost: { required: true },
            UnitRetail: { required: true },
            PackCost: { required: true },
            PackRetailCost: { required: true }
            //price:{required: true,range: [1, 100000]}
        },
        messages:
        {
            ProductName: { required: 'Name is required', minlength: 'Minimum length is 1', maxlength: 'Maximum length is 50' },
            Description: { maxlength: 'Max length is 100' },
            GenericName: { required: 'Generice Name is required' },
            BatchNo: { required: 'Batch No is required' },
            BarCode: { required: 'BarCode is required' },
            Description: { required: 'Description is required' },
            CompanyId: { required: 'CompanyName is required' },
            DistributorId: { required: 'Distributor is required' },
            CategoryId: { required: 'Category is required' },
            MinStock: { required: 'MinStock is required' },
            PackSize: { required: 'PackSize is required' },
            Location: { required: 'Location is required' },
            ManufactureDate: { required: 'ManufactureDate is required' },
            ExpiryDate: { required: 'ExpiryDate is required' },
            UnitCost: { required: 'UnitCost is required' },
            UnitRetail: { required: 'UnitRetail is required' },
            PackCost: { required: 'PackCost is required' },
            PackRetailCost: { required: 'PackRetailCost is required' }
            //Price: {required: 'Price is required',range: 'Price must be available within 1-100000'}
        }
    }
    );
    $("#updateBtn").click(function () {

        if ($("#createProduct").valid()) {
            //event.preventDefualt is used to show the sweet alert if we not use this the sweet alert is disappear immediately.
            event.preventDefault();
            $.ajax(
                {
                    type: 'post',
                    url: '/Product/Edit',
                    data: $("#createProduct").serialize()
                })
                .done(function (response) {
                    swal({
                        title: "Product Updated!",
                        text: "Product Updated Successfully!!",
                        type: "success"
                    }).then(function () {
                        window.location = "/product";
                    });

                }).fail(function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Fail");
                });
            $("#createProduct").trigger("reset");
        }
        else {
            swal({
                title: "Warning",
                text: "Please enter all valid data required fields",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            });
        }

    });
</script>